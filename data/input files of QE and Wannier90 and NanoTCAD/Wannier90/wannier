#!/bin/sh
# Wannier90 to get nnkp

cat > LS7_2_9_2.win <<EOF
num_bands         =   500       
num_wann          =   64


dis_froz_max = -0.75d0	
dis_froz_min = -4.50d0
dis_win_max =  10.0d0
dis_win_min = -15.0d0
dis_conv_tol = 1.5E-4
conv_tol = 1.0d-9

dis_num_iter     = 20000
num_iter         = 0
search_shells = 400

bands_plot = true
write_hr = true

guiding_centres = true
write_xyz=true

begin kpoint_path
G 0.0000000000     0.0000000000     0.0000000000  P 0.0000000000    0.0000000000     0.500000000
end kpoint_path

Begin Atoms_Cart
C        4.999998928  10.073798580   7.056049776
C        4.999998853  10.082954905  11.345237965
C        4.999998975  11.330134020   3.581209823
C        4.999998570  11.285662602   7.809858387
C        4.999999382  11.309049407  12.069240239
C        5.000000047  11.327298103  16.356227590
C        4.999998846  10.082955415   5.694772391
C        4.999998426  10.073800611   9.983954579
C        4.999999343  12.525137058   2.855875800
C        4.999998783  12.527402624   7.108428738
C        4.999999486  12.539832113  11.349303443
C        5.000000244  12.531234945  15.622715045
C        4.999999661  13.765451420   3.558054520
C        4.999999501  13.764709460   7.813880215
C        5.000000307  13.766792312  12.062425446
C        5.000000278  13.762398353  16.325688613
C        4.999999504  11.327300262   0.683765183
C        4.999998721  11.309050216   4.970764829
C        4.999998508  11.285663113   9.230147594
C        4.999999732  11.330136004  13.458793194
C        4.999999615  12.531234430   1.417281850
C        4.999998795  12.539831657   5.690702860
C        4.999999020  12.527403299   9.931574540
C        5.000000314  12.525137369  14.184122153
C        5.000000343  15.000001300   2.842956693
C        5.000000434  15.000001565   7.101919205
C        5.000000777  14.999999561  11.351215131
C        5.000000365  14.999999641  15.612944930
C        5.000000804  16.234551963   3.558053673
C        5.000001221  16.235291703   7.813880995
C        5.000001280  16.233207592  12.062423648
C        5.000000164  16.237601796  16.325687736
C        5.000000040  13.762400373   0.714306218
C        4.999999499  13.766792257   4.977577588
C        4.999999639  13.764709761   9.226122803
C        5.000000672  13.765450557  13.481947137
C        5.000000232  15.000002538   1.427051577
C        5.000000339  15.000001554   5.688788130
C        5.000000637  14.999999559   9.938083564
C        5.000000713  14.999999834  14.197039803
C        5.000000701  17.474864331   2.855875435
C        5.000001395  17.472598869   7.108429530
C        5.000001560  17.460167122  11.349299884
C        5.000000071  17.468764469  15.622712030
C        5.000000427  18.669866906   3.581209606
C        5.000001198  18.714336622   7.809859733
C        5.000001120  18.690949141  12.069237798
C        4.999999910  18.672700950  16.356225725
C        5.000000167  16.237603039   0.714305184
C        5.000000818  16.233210912   4.977576593
C        5.000001372  16.235289879   9.226122631
C        5.000000921  16.234548645  13.481945130
C        5.000000176  17.468769050   1.417281661
C        5.000001058  17.460169962   5.690702546
C        5.000001611  17.472596379   9.931572949
C        5.000000457  17.474863073  14.184118745
C        5.000000519  19.926199508   7.056050391
C        5.000000485  19.917042157  11.345233900
C        4.999999954  18.672700780   0.683762441
C        5.000000667  18.690950851   4.970765193
C        5.000001210  18.714336754   9.230147173
C        5.000000512  18.669862179  13.458789749
C        5.000000269  19.917044319   5.694771500
C        5.000000391  19.926196616   9.983955353
H        4.999999330   9.116661205   7.571941762
H        4.999998862   9.146102199  11.903545423
H        4.999999313   9.146103558   5.136462287
H        4.999998361   9.116664388   9.468064195
H        5.000000083  20.883336587   7.571938899
H        4.999999788  20.853894713  11.903543261
H        4.999999718  20.853897179   5.136464227
H        4.999999484  20.883332672   9.468062117
H        4.999998804  10.370283601   3.068906345
H        5.000000281  10.369692678  15.841498422
H        4.999998889  10.369694206   1.198496746
H        4.999999666  10.370282169  13.971098717
H        4.999999509  19.629715324   3.068907074
H        4.999999807  19.630306667  15.841496611
H        5.000000234  19.630307619   1.198492921
H        4.999999905  19.629716465  13.971094907
End Atoms_Cart
    
Begin Projections  
c=        4.999998928,  10.073798580,   7.056049776: pz:z=1,0,0
c=        4.999998853,  10.082954905,  11.345237965: pz:z=1,0,0
c=        4.999998975,  11.330134020,   3.581209823: pz:z=1,0,0
c=        4.999998570,  11.285662602,   7.809858387: pz:z=1,0,0
c=        4.999999382,  11.309049407,  12.069240239: pz:z=1,0,0
c=        5.000000047,  11.327298103,  16.356227590: pz:z=1,0,0
c=        4.999998846,  10.082955415,   5.694772391: pz:z=1,0,0
c=        4.999998426,  10.073800611,   9.983954579: pz:z=1,0,0
c=        4.999999343,  12.525137058,   2.855875800: pz:z=1,0,0
c=        4.999998783,  12.527402624,   7.108428738: pz:z=1,0,0
c=        4.999999486,  12.539832113,  11.349303443: pz:z=1,0,0
c=        5.000000244,  12.531234945,  15.622715045: pz:z=1,0,0
c=        4.999999661,  13.765451420,   3.558054520: pz:z=1,0,0
c=        4.999999501,  13.764709460,   7.813880215: pz:z=1,0,0
c=        5.000000307,  13.766792312,  12.062425446: pz:z=1,0,0
c=        5.000000278,  13.762398353,  16.325688613: pz:z=1,0,0
c=        4.999999504,  11.327300262,   0.683765183: pz:z=1,0,0
c=        4.999998721,  11.309050216,   4.970764829: pz:z=1,0,0
c=        4.999998508,  11.285663113,   9.230147594: pz:z=1,0,0
c=        4.999999732,  11.330136004,  13.458793194: pz:z=1,0,0
c=        4.999999615,  12.531234430,   1.417281850: pz:z=1,0,0
c=        4.999998795,  12.539831657,   5.690702860: pz:z=1,0,0
c=        4.999999020,  12.527403299,   9.931574540: pz:z=1,0,0
c=        5.000000314,  12.525137369,  14.184122153: pz:z=1,0,0
c=        5.000000343,  15.000001300,   2.842956693: pz:z=1,0,0
c=        5.000000434,  15.000001565,   7.101919205: pz:z=1,0,0
c=        5.000000777,  14.999999561,  11.351215131: pz:z=1,0,0
c=        5.000000365,  14.999999641,  15.612944930: pz:z=1,0,0
c=        5.000000804,  16.234551963,   3.558053673: pz:z=1,0,0
c=        5.000001221,  16.235291703,   7.813880995: pz:z=1,0,0
c=        5.000001280,  16.233207592,  12.062423648: pz:z=1,0,0
c=        5.000000164,  16.237601796,  16.325687736: pz:z=1,0,0
c=        5.000000040,  13.762400373,   0.714306218: pz:z=1,0,0
c=        4.999999499,  13.766792257,   4.977577588: pz:z=1,0,0
c=        4.999999639,  13.764709761,   9.226122803: pz:z=1,0,0
c=        5.000000672,  13.765450557,  13.481947137: pz:z=1,0,0
c=        5.000000232,  15.000002538,   1.427051577: pz:z=1,0,0
c=        5.000000339,  15.000001554,   5.688788130: pz:z=1,0,0
c=        5.000000637,  14.999999559,   9.938083564: pz:z=1,0,0
c=        5.000000713,  14.999999834,  14.197039803: pz:z=1,0,0
c=        5.000000701,  17.474864331,   2.855875435: pz:z=1,0,0
c=        5.000001395,  17.472598869,   7.108429530: pz:z=1,0,0
c=        5.000001560,  17.460167122,  11.349299884: pz:z=1,0,0
c=        5.000000071,  17.468764469,  15.622712030: pz:z=1,0,0
c=        5.000000427,  18.669866906,   3.581209606: pz:z=1,0,0
c=        5.000001198,  18.714336622,   7.809859733: pz:z=1,0,0
c=        5.000001120,  18.690949141,  12.069237798: pz:z=1,0,0
c=        4.999999910,  18.672700950,  16.356225725: pz:z=1,0,0
c=        5.000000167,  16.237603039,   0.714305184: pz:z=1,0,0
c=        5.000000818,  16.233210912,   4.977576593: pz:z=1,0,0
c=        5.000001372,  16.235289879,   9.226122631: pz:z=1,0,0
c=        5.000000921,  16.234548645,  13.481945130: pz:z=1,0,0
c=        5.000000176,  17.468769050,   1.417281661: pz:z=1,0,0
c=        5.000001058,  17.460169962,   5.690702546: pz:z=1,0,0
c=        5.000001611,  17.472596379,   9.931572949: pz:z=1,0,0
c=        5.000000457,  17.474863073,  14.184118745: pz:z=1,0,0
c=        5.000000519,  19.926199508,   7.056050391: pz:z=1,0,0
c=        5.000000485,  19.917042157,  11.345233900: pz:z=1,0,0
c=        4.999999954,  18.672700780,   0.683762441: pz:z=1,0,0
c=        5.000000667,  18.690950851,   4.970765193: pz:z=1,0,0
c=        5.000001210,  18.714336754,   9.230147173: pz:z=1,0,0
c=        5.000000512,  18.669862179,  13.458789749: pz:z=1,0,0
c=        5.000000269,  19.917044319,   5.694771500: pz:z=1,0,0
c=        5.000000391,  19.926196616,   9.983955353: pz:z=1,0,0
End Projections       
    
Begin Unit_Cell_Cart
10.000000   0.0000000   0.000000
 0.000000  30.0000000   0.000000
 0.000000   0.0000000   17.040000
End Unit_Cell_Cart

mp_grid      = 1 1 50  

begin kpoints
  0.00000000  0.00000000  0.00000000  2.000000e-02
  0.00000000  0.00000000  0.02000000  2.000000e-02
  0.00000000  0.00000000  0.04000000  2.000000e-02
  0.00000000  0.00000000  0.06000000  2.000000e-02
  0.00000000  0.00000000  0.08000000  2.000000e-02
  0.00000000  0.00000000  0.10000000  2.000000e-02
  0.00000000  0.00000000  0.12000000  2.000000e-02
  0.00000000  0.00000000  0.14000000  2.000000e-02
  0.00000000  0.00000000  0.16000000  2.000000e-02
  0.00000000  0.00000000  0.18000000  2.000000e-02
  0.00000000  0.00000000  0.20000000  2.000000e-02
  0.00000000  0.00000000  0.22000000  2.000000e-02
  0.00000000  0.00000000  0.24000000  2.000000e-02
  0.00000000  0.00000000  0.26000000  2.000000e-02
  0.00000000  0.00000000  0.28000000  2.000000e-02
  0.00000000  0.00000000  0.30000000  2.000000e-02
  0.00000000  0.00000000  0.32000000  2.000000e-02
  0.00000000  0.00000000  0.34000000  2.000000e-02
  0.00000000  0.00000000  0.36000000  2.000000e-02
  0.00000000  0.00000000  0.38000000  2.000000e-02
  0.00000000  0.00000000  0.40000000  2.000000e-02
  0.00000000  0.00000000  0.42000000  2.000000e-02
  0.00000000  0.00000000  0.44000000  2.000000e-02
  0.00000000  0.00000000  0.46000000  2.000000e-02
  0.00000000  0.00000000  0.48000000  2.000000e-02
  0.00000000  0.00000000  0.50000000  2.000000e-02
  0.00000000  0.00000000  0.52000000  2.000000e-02
  0.00000000  0.00000000  0.54000000  2.000000e-02
  0.00000000  0.00000000  0.56000000  2.000000e-02
  0.00000000  0.00000000  0.58000000  2.000000e-02
  0.00000000  0.00000000  0.60000000  2.000000e-02
  0.00000000  0.00000000  0.62000000  2.000000e-02
  0.00000000  0.00000000  0.64000000  2.000000e-02
  0.00000000  0.00000000  0.66000000  2.000000e-02
  0.00000000  0.00000000  0.68000000  2.000000e-02
  0.00000000  0.00000000  0.70000000  2.000000e-02
  0.00000000  0.00000000  0.72000000  2.000000e-02
  0.00000000  0.00000000  0.74000000  2.000000e-02
  0.00000000  0.00000000  0.76000000  2.000000e-02
  0.00000000  0.00000000  0.78000000  2.000000e-02
  0.00000000  0.00000000  0.80000000  2.000000e-02
  0.00000000  0.00000000  0.82000000  2.000000e-02
  0.00000000  0.00000000  0.84000000  2.000000e-02
  0.00000000  0.00000000  0.86000000  2.000000e-02
  0.00000000  0.00000000  0.88000000  2.000000e-02
  0.00000000  0.00000000  0.90000000  2.000000e-02
  0.00000000  0.00000000  0.92000000  2.000000e-02
  0.00000000  0.00000000  0.94000000  2.000000e-02
  0.00000000  0.00000000  0.96000000  2.000000e-02
  0.00000000  0.00000000  0.98000000  2.000000e-02
End Kpoints
EOF

echo "running wannier90 -pp for nnkp gap file "
#wannier90.x -pp LS7_2_9_2
echo "end "

# creat mn file for band ground

cat > LS7_2_9_2.pw2wan.in << EOF
&inputpp 
  outdir='/home/zfwang/scratch/GNRDATASET/AGNR/LS7_2_9_2'
  prefix='LS7_2_9_2'
  seedname = 'LS7_2_9_2'
  write_mmn = true
  write_amn = true
  write_unk = false
  wan_mode = 'standalone'
/
EOF

echo "running pw2wannier90  for mn file "
#pw2wannier90.x <LS7_2_9_2.pw2wan.in> LS7_2_9_2.pw2wan.out
echo "end "

#  get MLWFs
#####
echo "running wannier90  for MLWFs"
wannier90.x LS7_2_9_2
echo "end "
